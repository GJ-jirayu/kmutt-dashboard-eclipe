-- 1.1 --
SELECT DIM_DATE.CALENDAR_YEAR
,HR_DIM_EMP_TYPE.EMP_TYPE_NAME
,count(HR_FACT_EMPLOYEE.EMP_KEY) as no_of_emp
,HR_DIM_EMP_TYPE.EMP_TYPE_CODE
FROM HR_FACT_EMPLOYEE
left join DIM_DATE on DIM_DATE.DATE_KEY = HR_FACT_EMPLOYEE.MONTH_KEY
left join HR_DIM_POSITION_GROUP on HR_DIM_POSITION_GROUP.POSITION_GROUP_KEY = HR_FACT_EMPLOYEE.POSITION_GROUP_KEY
left join HR_DIM_EMP_TYPE on HR_DIM_EMP_TYPE.EMP_TYPE_KEY = HR_FACT_EMPLOYEE.EMP_TYPE_KEY
left join HR_DIM_EMP_LINE       on HR_DIM_EMP_LINE.EMP_LINE_KEY = HR_FACT_EMPLOYEE.EMP_LINE_KEY
where DIM_DATE.CALENDAR_YEAR between ('2552') and ('2556')
and HR_DIM_POSITION_GROUP.POSITION_GROUP_CODE = '1000'
and HR_DIM_EMP_TYPE.EMP_TYPE_CODE || HR_DIM_EMP_LINE.EMP_LINE_CODE = '1104'
group by DIM_DATE.CALENDAR_YEAR
,HR_DIM_EMP_TYPE.EMP_TYPE_CODE
,HR_DIM_EMP_TYPE.EMP_TYPE_NAME
order by HR_DIM_EMP_TYPE.EMP_TYPE_CODE
,DIM_DATE.CALENDAR_YEAR

-- 1.2 --
SELECT ORGENIZATION_NAME
,EMP_TYPE_NAME
,count(EMP_KEY) as no_of_emp
,EMP_TYPE_CODE
,ORGENIZATION_CODE
FROM HR_FACT_EMPLOYEE
left join DIM_DATE on DIM_DATE.DATE_KEY = HR_FACT_EMPLOYEE.MONTH_KEY
left join HR_DIM_EMP_TYPE on HR_DIM_EMP_TYPE.EMP_TYPE_KEY = HR_FACT_EMPLOYEE.EMP_TYPE_KEY
left join HR_DIM_DEPARTMENT on HR_DIM_DEPARTMENT.DEPARTMENT_KEY = HR_FACT_EMPLOYEE.DEPARTMENT_KEY
left join HR_DIM_POSITION_GROUP on HR_DIM_POSITION_GROUP.POSITION_GROUP_KEY = HR_FACT_EMPLOYEE.POSITION_GROUP_KEY
where CALENDAR_YEAR between ('2556')-5 and ('2556')
and POSITION_TYPE_GROUP_CODE = '1'
group by ORGENIZATION_NAME,EMP_TYPE_CODE,EMP_TYPE_NAME,ORGENIZATION_CODE
order by EMP_TYPE_CODE,ORGENIZATION_CODE

-- 2.1 --
SELECT CALENDAR_YEAR
,EDUCATION_LEVEL_NAME
,count(EMP_KEY) as no_of_emp
,EDUCATION_LEVEL_CODE
FROM HR_FACT_EMPLOYEE
left join DIM_DATE on DIM_DATE.DATE_KEY = HR_FACT_EMPLOYEE.MONTH_KEY
left join HR_DIM_EDUCATION_LEVEL on HR_DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_KEY = HR_FACT_EMPLOYEE.EDUCATION_LEVEL_KEY
where CALENDAR_YEAR between ('2556')-5 and ('2556')
group by CALENDAR_YEAR,EDUCATION_LEVEL_CODE,EDUCATION_LEVEL_NAME
order by EDUCATION_LEVEL_CODE,CALENDAR_YEAR

-- 2.2 --
SELECT ORGENIZATION_NAME
,EDUCATION_LEVEL_NAME
,count(EMP_KEY) as no_of_emp
,EDUCATION_LEVEL_CODE
,ORGENIZATION_CODE
FROM HR_FACT_EMPLOYEE
left join DIM_DATE on DIM_DATE.DATE_KEY = HR_FACT_EMPLOYEE.MONTH_KEY
left join HR_DIM_EDUCATION_LEVEL on HR_DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_KEY = HR_FACT_EMPLOYEE.EDUCATION_LEVEL_KEY
left join HR_DIM_DEPARTMENT on HR_DIM_DEPARTMENT.DEPARTMENT_KEY = HR_FACT_EMPLOYEE.DEPARTMENT_KEY
where CALENDAR_YEAR between ('2556')-5 and ('2556')
group by ORGENIZATION_NAME,EDUCATION_LEVEL_CODE,EDUCATION_LEVEL_NAME,ORGENIZATION_CODE
order by EDUCATION_LEVEL_CODE,ORGENIZATION_CODE

-- 3.1 --
SELECT CALENDAR_YEAR
,LEVEL_NAME
,count(EMP_KEY) as no_of_emp
,LEVEL_CODE
FROM HR_FACT_EMPLOYEE
left join DIM_DATE on DIM_DATE.DATE_KEY = HR_FACT_EMPLOYEE.MONTH_KEY
left join HR_DIM_LEVEL on HR_DIM_LEVEL.LEVEL_KEY = HR_FACT_EMPLOYEE.LEVEL_KEY
where CALENDAR_YEAR between ('2556')-5 and ('2556')
-- and LEVEL_CODE = 'A14'
group by CALENDAR_YEAR,LEVEL_CODE,LEVEL_NAME
order by LEVEL_CODE,CALENDAR_YEAR

-- 3.2 --
SELECT ORGENIZATION_NAME
,LEVEL_NAME
,count(EMP_KEY) as no_of_emp
,LEVEL_CODE
,CAST(SUB_LEVEL_CODE AS INT) as SUB_LEVEL_CODE
,ORGENIZATION_CODE
FROM HR_FACT_EMPLOYEE
left join DIM_DATE on DIM_DATE.DATE_KEY = HR_FACT_EMPLOYEE.MONTH_KEY
left join HR_DIM_LEVEL on HR_DIM_LEVEL.LEVEL_KEY = HR_FACT_EMPLOYEE.LEVEL_KEY
left join HR_DIM_DEPARTMENT on HR_DIM_DEPARTMENT.DEPARTMENT_KEY = HR_FACT_EMPLOYEE.DEPARTMENT_KEY
where CALENDAR_YEAR between ('2556')-5 and ('2556')
and LEVEL_CODE = 'A14'
group by ORGENIZATION_NAME,LEVEL_CODE,LEVEL_NAME,SUB_LEVEL_CODE,ORGENIZATION_CODE
order by SUB_LEVEL_CODE desc,ORGENIZATION_CODE

-- 4.1 --
-- 4.2 --
-- 4.3 --
-- 5.1 --
-- 5.2 --
-- 6.1 --
-- 6.2 --
-- 7.1 --
-- 7.2 --
-- 8.1 --
SELECT AGE_RANGE_DESC
,LEVEL_NAME
,count(EMP_KEY) as no_of_emp
,LEVEL_CODE
,AGE_RANGE_CODE
FROM HR_FACT_EMPLOYEE
left join DIM_DATE on DIM_DATE.DATE_KEY = HR_FACT_EMPLOYEE.MONTH_KEY
left join HR_DIM_LEVEL on HR_DIM_LEVEL.LEVEL_KEY = HR_FACT_EMPLOYEE.LEVEL_KEY
left join HR_DIM_AGE_RANGE on HR_DIM_AGE_RANGE.AGE_RANGE_KEY = HR_FACT_EMPLOYEE.AGE_RANGE_KEY
where CALENDAR_YEAR = ('2556')
and LEVEL_CODE = 'A15'
group by AGE_RANGE_DESC,LEVEL_CODE,LEVEL_NAME,AGE_RANGE_CODE
order by LEVEL_CODE,AGE_RANGE_CODE
-- 8.2 --
SELECT LEVEL_NAME
,'จำนวน(คน)' as typename
,count(EMP_KEY) as no_of_emp
,LEVEL_CODE
FROM HR_FACT_EMPLOYEE
left join DIM_DATE on DIM_DATE.DATE_KEY = HR_FACT_EMPLOYEE.MONTH_KEY
left join HR_DIM_LEVEL on HR_DIM_LEVEL.LEVEL_KEY = HR_FACT_EMPLOYEE.LEVEL_KEY
where CALENDAR_YEAR = ('2556')
and LEVEL_CODE = 'A15'
group by LEVEL_CODE,LEVEL_NAME
order by LEVEL_CODE
-- 8.3 --
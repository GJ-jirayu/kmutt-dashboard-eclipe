CREATE PROCEDURE emp_paramEmpTypeLine(IN paramEmpTypeGroup VARCHAR(256)) 
DYNAMIC RESULT SETS 1 
LANGUAGE SQL 
BEGIN 
    DECLARE result_set_1 CURSOR WITH RETURN TO CLIENT FOR
	
select EMP_LINE_GROUP_CODE
,EMP_LINE_GROUP_NAME
from
(
        select EMP_LINE_GROUP_CODE
        ,EMP_LINE_GROUP_NAME
		from
			(	
			SELECT EMP_TYPE_Code || EMP_GROUP_CODE || EMP_TYPE_GROUP_CODE as TGTY_CODE
			, EMP_TYPE_NAME ||' '|| EMP_GROUP_NAME ||' '|| EMP_TYPE_GROUP_NAME as TGTY_NAME
			, EMP_LINE_GROUP_CODE 
			, EMP_LINE_GROUP_NAME
			FROM HR_FACT_EMPLOYEE
			left join DIM_DATE on DIM_DATE.DATE_KEY = HR_FACT_EMPLOYEE.MONTH_KEY
			left join HR_DIM_LEVEL on HR_DIM_LEVEL.LEVEL_KEY = HR_FACT_EMPLOYEE.LEVEL_KEY
			left join HR_DIM_AGE_RANGE on HR_DIM_AGE_RANGE.AGE_RANGE_KEY = HR_FACT_EMPLOYEE.AGE_RANGE_KEY
			left join HR_DIM_POSITION_GROUP on HR_DIM_POSITION_GROUP.POSITION_GROUP_KEY = HR_FACT_EMPLOYEE.POSITION_GROUP_KEY
			left join HR_DIM_EMP_TYPE on HR_DIM_EMP_TYPE.EMP_TYPE_KEY = HR_FACT_EMPLOYEE.EMP_TYPE_KEY
			left join HR_DIM_EMP_LINE_GROUP on HR_DIM_EMP_LINE_GROUP.EMP_LINE_GROUP_KEY = HR_FACT_EMPLOYEE.EMP_LINE_KEY
			left join HR_DIM_DEPARTMENT on HR_DIM_DEPARTMENT.DEPARTMENT_KEY = HR_FACT_EMPLOYEE.DEPARTMENT_KEY
			where (EMP_TYPE_GROUP_CODE in ('1','2','3','4'))
			and (EMP_GROUP_CODE in ('1','2','3'))
			and (EMP_TYPE_CODE in ('1','2','6'))
			group by EMP_TYPE_Code || EMP_GROUP_CODE || EMP_TYPE_GROUP_CODE
			, EMP_TYPE_NAME ||' '|| EMP_GROUP_NAME ||' '|| EMP_TYPE_GROUP_NAME
			, EMP_LINE_GROUP_CODE 
			, EMP_LINE_GROUP_NAME
		)kmutt 
		where (TGTY_CODE in (paramEmpTypeGroup) or 'All' in (paramEmpTypeGroup))
		group by EMP_LINE_GROUP_CODE
        ,EMP_LINE_GROUP_NAME
	
        union
        
        SELECT 'All' as EMP_LINE_GROUP_CODE
		,'รวม' as EMP_LINE_GROUP_NAME
        from sysibm.sysdummy1
)gj
order by EMP_LINE_GROUP_CODE
,EMP_LINE_GROUP_NAME

	;
		
    OPEN result_set_1;
END
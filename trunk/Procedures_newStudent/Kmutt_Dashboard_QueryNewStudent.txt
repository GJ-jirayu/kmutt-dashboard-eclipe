--  นักศึกษาใหม่_กราฟ 1.1 (กราฟแท่งกับเส้น)
select ACADEMIC_YEAR
,ADMISSIONTYPE
,TOTELADMISSION
from
(
SELECT DIM_SEMESTER.ACADEMIC_YEAR
,'ผู้สมัคร' as ADMISSIONTYPE
,sum(FACT_ADMISSION.NO_OF_CANDIDATE) as TOTELADMISSION
FROM FACT_ADMISSION
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ADMISSION.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ADMISSION.PROGRAM_KEY
left join DIM_ADMISSION_TYPE on DIM_ADMISSION_TYPE.ADMISSION_TYPE_KEY = FACT_ADMISSION.ADMISSION_TYPE_KEY
where DIM_SEMESTER.ACADEMIC_YEAR between ('2555') and ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001')
and DIM_ADMISSION_TYPE.ADMISSION_TYPE_CODE in ('2')
group by DIM_SEMESTER.ACADEMIC_YEAR

union

SELECT DIM_SEMESTER.ACADEMIC_YEAR
,'ผู้มีสิทธิ์เข้าศึกษา' as ADMISSIONTYPE
,sum(FACT_ADMISSION.NO_OF_QUALIFIER) as TOTELADMISSION
FROM FACT_ADMISSION
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ADMISSION.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ADMISSION.PROGRAM_KEY
left join DIM_ADMISSION_TYPE on DIM_ADMISSION_TYPE.ADMISSION_TYPE_KEY = FACT_ADMISSION.ADMISSION_TYPE_KEY
where DIM_SEMESTER.ACADEMIC_YEAR between ('2555') and ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001')
and DIM_ADMISSION_TYPE.ADMISSION_TYPE_CODE in ('2')
group by DIM_SEMESTER.ACADEMIC_YEAR

union

SELECT DIM_SEMESTER.ACADEMIC_YEAR
,'นักศึกษาลงทะเบียน' as ADMISSIONTYPE
,sum(FACT_ADMISSION.NO_OF_REGISTERED) as TOTELADMISSION
FROM FACT_ADMISSION
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ADMISSION.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ADMISSION.PROGRAM_KEY
left join DIM_ADMISSION_TYPE on DIM_ADMISSION_TYPE.ADMISSION_TYPE_KEY = FACT_ADMISSION.ADMISSION_TYPE_KEY
where DIM_SEMESTER.ACADEMIC_YEAR between ('2555') and ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001')
and DIM_ADMISSION_TYPE.ADMISSION_TYPE_CODE in ('2')
group by DIM_SEMESTER.ACADEMIC_YEAR
)ADMISSION
order by ACADEMIC_YEAR,ADMISSIONTYPE asc

-- นักศึกษาใหม่_กราฟ 1.2 (กราฟแท่งกับเส้น)
select FACULTY_NAME,ADMISSIONTYPE,TOTELADMISSION
from 
(SELECT FACULTY_NAME
,'ผู้สมัคร' as ADMISSIONTYPE
,sum(FACT_ADMISSION.NO_OF_CANDIDATE) as TOTELADMISSION
FROM FACT_ADMISSION
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ADMISSION.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ADMISSION.PROGRAM_KEY
left join DIM_ADMISSION_TYPE on DIM_ADMISSION_TYPE.ADMISSION_TYPE_KEY = FACT_ADMISSION.ADMISSION_TYPE_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_ADMISSION.FIELD_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2555')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001')
and DIM_ADMISSION_TYPE.ADMISSION_TYPE_CODE in ('2')
group by DIM_SEMESTER.ACADEMIC_YEAR , DIM_FIELD.FACULTY_CODE , DIM_FIELD.FACULTY_NAME

union
SELECT FACULTY_NAME
,'ผู้มีสิทธิ์เข้าศึกษา' as ADMISSIONTYPE
,sum(FACT_ADMISSION.NO_OF_QUALIFIER) as TOTELADMISSION
FROM FACT_ADMISSION
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ADMISSION.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ADMISSION.PROGRAM_KEY
left join DIM_ADMISSION_TYPE on DIM_ADMISSION_TYPE.ADMISSION_TYPE_KEY = FACT_ADMISSION.ADMISSION_TYPE_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_ADMISSION.FIELD_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2555')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001')
and DIM_ADMISSION_TYPE.ADMISSION_TYPE_CODE in ('2')
group by DIM_SEMESTER.ACADEMIC_YEAR , DIM_FIELD.FACULTY_CODE , DIM_FIELD.FACULTY_NAME

union
SELECT FACULTY_NAME
,'นักศึกษาลงทะเบียน' as ADMISSIONTYPE
,sum(FACT_ADMISSION.NO_OF_REGISTERED) as TOTELADMISSION
FROM FACT_ADMISSION
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ADMISSION.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ADMISSION.PROGRAM_KEY
left join DIM_ADMISSION_TYPE on DIM_ADMISSION_TYPE.ADMISSION_TYPE_KEY = FACT_ADMISSION.ADMISSION_TYPE_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_ADMISSION.FIELD_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2555')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001')
and DIM_ADMISSION_TYPE.ADMISSION_TYPE_CODE in ('2')
group by DIM_SEMESTER.ACADEMIC_YEAR , DIM_FIELD.FACULTY_CODE , DIM_FIELD.FACULTY_NAME
)
order by FACULTY_NAME,ADMISSIONTYPE

-- นักศึกษาใหม่_กราฟ 2.1 (กราฟแท่ง)
SELECT DIM_FIELD.FACULTY_NAME
,DIM_ADMISSION_TYPE.ADMISSION_TYPE_NAME
,sum(FACT_NEW_STUDENT.NO_OF_STUDENT) as NO_OF_STUDENT
FROM FACT_NEW_STUDENT
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_NEW_STUDENT.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_NEW_STUDENT.PROGRAM_KEY
left join DIM_ADMISSION_TYPE on DIM_ADMISSION_TYPE.ADMISSION_TYPE_KEY = FACT_NEW_STUDENT.ADMISSION_TYPE_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_NEW_STUDENT.FIELD_KEY
where DIM_ADMISSION_TYPE.ADMISSION_TYPE_CODE not in ('N/A','3')
and DIM_SEMESTER.ACADEMIC_YEAR in ('2555')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001')
group by DIM_FIELD.FACULTY_NAME
,DIM_ADMISSION_TYPE.ADMISSION_TYPE_NAME
order by DIM_ADMISSION_TYPE.ADMISSION_TYPE_NAME

-- นักศึกษาใหม่_กราฟ 2.2(กราฟแท่ง)
SELECT DIM_FIELD.FACULTY_NAME
,DIM_GRADE_RANGE.GRADE_RANGE_DESC
,Sum(FACT_PRE_ADMISSION_GRADE.no_of_student) as no_of_student
FROM FACT_PRE_ADMISSION_GRADE
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_PRE_ADMISSION_GRADE.SEMESTER_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_PRE_ADMISSION_GRADE.FIELD_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_PRE_ADMISSION_GRADE.PROGRAM_KEY
left join DIM_GRADE_RANGE on DIM_GRADE_RANGE.GRADE_RANGE_KEY = FACT_PRE_ADMISSION_GRADE.GRADE_RANGE_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2555')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001')
group by DIM_FIELD.FACULTY_NAME,DIM_GRADE_RANGE.GRADE_RANGE_DESC
order by DIM_GRADE_RANGE.GRADE_RANGE_DESC 

-- นักศึกษาใหม่_กราฟ 2.3 (กราฟวงกลม)
SELECT DIM_FIELD.FACULTY_NAME
,sum(FACT_NEW_STUDENT.NO_OF_STUDENT) as NO_OF_STUDENT
FROM FACT_NEW_STUDENT
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_NEW_STUDENT.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_NEW_STUDENT.PROGRAM_KEY
left join DIM_ADMISSION_TYPE on DIM_ADMISSION_TYPE.ADMISSION_TYPE_KEY = FACT_NEW_STUDENT.ADMISSION_TYPE_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_NEW_STUDENT.FIELD_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2555')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001')
and DIM_ADMISSION_TYPE.ADMISSION_TYPE_CODE in ('2')
group by DIM_SEMESTER.ACADEMIC_YEAR,DIM_FIELD.FACULTY_NAME
order by NO_OF_STUDENT desc

-- นักศึกษาใหม่_กราฟ 3.1 (กราฟแท่งกับเส้น)
select ACADEMIC_YEAR,ACTUALPLANTYPE,TOTELACTUALPLAN
from(
SELECT DIM_SEMESTER.ACADEMIC_YEAR 
,'จำนวนนักศึกษาใหม่' as ACTUALPLANTYPE
,sum(FACT_ACTUAL_PLAN.NO_OF_ACTUAL_NEW_STUDENT) as TOTELACTUALPLAN
FROM FACT_ACTUAL_PLAN
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ACTUAL_PLAN.SEMESTER_KEY
left join DIM_EDUCATION_LEVEL on DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_KEY = FACT_ACTUAL_PLAN.EDUCATION_LEVEL_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_CODE in ('001')
group by DIM_SEMESTER.ACADEMIC_YEAR

union

SELECT DIM_SEMESTER.ACADEMIC_YEAR 
,'แผน' as ACTUALPLANTYPE
,sum(FACT_ACTUAL_PLAN.NO_OF_PLAN_NEW_STUDENT) as TOTELACTUALPLAN
FROM FACT_ACTUAL_PLAN
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ACTUAL_PLAN.SEMESTER_KEY
left join DIM_EDUCATION_LEVEL on DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_KEY = FACT_ACTUAL_PLAN.EDUCATION_LEVEL_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_CODE in ('001')
group by DIM_SEMESTER.ACADEMIC_YEAR
)ACTUAL_PLAN
order by ACADEMIC_YEAR,ACTUALPLANTYPE asc

-- นักศึกษาใหม่_กราฟ 3.2 (กราฟวงกลม)
SELECT SCHOOL_NAME
,sum(NO_OF_STUDENT) as NO_OF_STUDENT
FROM FACT_PRE_ADMISSION_GRADE
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_PRE_ADMISSION_GRADE.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_PRE_ADMISSION_GRADE.PROGRAM_KEY
left join DIM_SCHOOL on DIM_SCHOOL.SCHOOL_KEY = FACT_PRE_ADMISSION_GRADE.SCHOOL_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001')
group by DIM_SEMESTER.ACADEMIC_YEAR,SCHOOL_NAME
order by NO_OF_STUDENT DESC
FETCH FIRST 10 ROWS ONLY

-- นักศึกษาใหม่_กราฟ 3.3 (กราฟแท่งกับเส้น)
select FACULTY_NAME,NEW_STUDENT_TYPE,NO_OF_NEW_STUDENT_ACTUAL_PLAN
from
(SELECT DIM_FIELD.FACULTY_NAME 
,'จำนวนนักศึกษาใหม่' as NEW_STUDENT_TYPE
,sum(FACT_ACTUAL_PLAN.NO_OF_ACTUAL_NEW_STUDENT) as NO_OF_NEW_STUDENT_ACTUAL_PLAN
FROM FACT_ACTUAL_PLAN
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ACTUAL_PLAN.SEMESTER_KEY
left join DIM_EDUCATION_LEVEL on DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_KEY = FACT_ACTUAL_PLAN.EDUCATION_LEVEL_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_ACTUAL_PLAN.FIELD_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_CODE in ('001')
group by DIM_SEMESTER.ACADEMIC_YEAR,DIM_FIELD.FACULTY_CODE,DIM_FIELD.FACULTY_NAME

union 

SELECT DIM_FIELD.FACULTY_NAME 
,'แผน' as NEW_STUDENT_TYPE
,sum(FACT_ACTUAL_PLAN.NO_OF_PLAN_NEW_STUDENT) as NO_OF_NEW_STUDENT_ACTUAL_PLAN
FROM FACT_ACTUAL_PLAN
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ACTUAL_PLAN.SEMESTER_KEY
left join DIM_EDUCATION_LEVEL on DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_KEY = FACT_ACTUAL_PLAN.EDUCATION_LEVEL_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_ACTUAL_PLAN.FIELD_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_CODE in ('001')
group by DIM_SEMESTER.ACADEMIC_YEAR,DIM_FIELD.FACULTY_CODE,DIM_FIELD.FACULTY_NAME
) ACTUAL_PLAN
order by NEW_STUDENT_TYPE,FACULTY_NAME

-- นักศึกษาใหม่_กราฟ 4.1 (กราฟส้น)
SELECT DIM_SEMESTER.ACADEMIC_YEAR
,DIM_FIELD.FACULTY_NAME
,sum(FACT_NEW_STUDENT.NO_OF_STUDENT) as NO_OF_STUDENT
FROM FACT_NEW_STUDENT
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_NEW_STUDENT.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_NEW_STUDENT.PROGRAM_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_NEW_STUDENT.FIELD_KEY
where DIM_SEMESTER.ACADEMIC_YEAR between (2556)-(5) and (2556)
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001')
group by DIM_SEMESTER.ACADEMIC_YEAR,DIM_FIELD.FACULTY_CODE,DIM_FIELD.FACULTY_NAME
order by DIM_FIELD.FACULTY_CODE,DIM_SEMESTER.ACADEMIC_YEAR

-- นักศึกษาใหม่_กราฟ 5.1 (กราฟแผนที่+ตาราง)
select DIM_SCHOOL.PROVINCE,sum(NO_OF_STUDENT) as NO_OF_STUDENT
from FACT_PRE_ADMISSION_GRADE
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_PRE_ADMISSION_GRADE.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_PRE_ADMISSION_GRADE.PROGRAM_KEY
left join DIM_SCHOOL on DIM_SCHOOL.SCHOOL_KEY = FACT_PRE_ADMISSION_GRADE.SCHOOL_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001')
group by DIM_SEMESTER.ACADEMIC_YEAR,DIM_SEMESTER.SEMESTER_CODE,DIM_PROGRAM.EDUCATION_LEVEL_CODE,DIM_SCHOOL.PROVINCE
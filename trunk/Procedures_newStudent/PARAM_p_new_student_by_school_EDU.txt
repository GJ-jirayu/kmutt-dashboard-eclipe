CREATE PROCEDURE  p_new_student_by_school_EDU(IN paramEDU VARCHAR(256)) 
DYNAMIC RESULT SETS 1 
LANGUAGE SQL 
BEGIN 
    DECLARE result_set_1 CURSOR WITH RETURN TO CLIENT FOR
	
select EDUCATION_LEVEL_CODE,EDUCATION_LEVEL_NAME
from
(
SELECT distinct EDUCATION_LEVEL_CODE 
, concat('ระดับ',EDUCATION_LEVEL_NAME) as EDUCATION_LEVEL_NAME
FROM DIM_EDUCATION_LEVEL
where EDUCATION_LEVEL_CODE not in ('004','005','006','N/A')

union

SELECT 'All' as EDUCATION_LEVEL_CODE
,'ทุกระดับการศึกษา' as EDUCATION_LEVEL_NAME
from sysibm.sysdummy1
)Education
where (EDUCATION_LEVEL_CODE = (paramEDU));

    OPEN result_set_1;
END
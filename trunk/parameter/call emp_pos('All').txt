CREATE PROCEDURE  emp_pos(IN paramEmpPos VARCHAR(256)) 
DYNAMIC RESULT SETS 1 
LANGUAGE SQL 
BEGIN 
    DECLARE result_set_1 CURSOR WITH RETURN TO CLIENT FOR
	
		select POSITION_GROUP_CODE
		,POSITION_GROUP_NAME
		from
		(
		SELECT HR_DIM_POSITION_GROUP.POSITION_GROUP_CODE
		, HR_DIM_POSITION_GROUP.POSITION_GROUP_NAME
		FROM HR_FACT_EMPLOYEE
                left join HR_DIM_POSITION_GROUP on HR_DIM_POSITION_GROUP.POSITION_GROUP_KEY = HR_FACT_EMPLOYEE.POSITION_GROUP_KEY
                left join HR_DIM_EMP_TYPE       on HR_DIM_EMP_TYPE.EMP_TYPE_KEY = HR_FACT_EMPLOYEE.EMP_TYPE_KEY
                left join HR_DIM_EMP_LINE_GROUP       on HR_DIM_EMP_LINE_GROUP.EMP_LINE_GROUP_KEY = HR_FACT_EMPLOYEE.EMP_LINE_KEY
		group by HR_DIM_POSITION_GROUP.POSITION_GROUP_CODE, HR_DIM_POSITION_GROUP.POSITION_GROUP_NAME

		union

		SELECT 'All' as POSITION_GROUP_CODE
		, 'บุคลากร' as POSITION_GROUP_NAME
		from sysibm.sysdummy1
		)kmutt
		where POSITION_GROUP_CODE = (paramEmpPos)
		
	;
    OPEN result_set_1;
END
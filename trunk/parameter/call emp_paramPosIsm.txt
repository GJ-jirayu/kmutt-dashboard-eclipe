CREATE PROCEDURE emp_paramPosIsm() 
DYNAMIC RESULT SETS 1 
LANGUAGE SQL 
BEGIN 
    DECLARE result_set_1 CURSOR WITH RETURN TO CLIENT FOR
				
select POSITION_GROUP_CODE
,POSITION_GROUP_NAME
from
(
SELECT 'All' as POSITION_GROUP_CODE
,'รวม' as POSITION_GROUP_NAME
, '2' as nos
from sysibm.sysdummy1

union

SELECT 
 HR_DIM_POSITION_GROUP.POSITION_GROUP_CODE
, HR_DIM_POSITION_GROUP.POSITION_GROUP_NAME
, '1' as nos
FROM HR_FACT_EMPLOYEE
left join HR_DIM_POSITION_GROUP on HR_DIM_POSITION_GROUP.POSITION_GROUP_KEY = HR_FACT_EMPLOYEE.POSITION_GROUP_KEY
left join HR_DIM_EMP_TYPE       on HR_DIM_EMP_TYPE.EMP_TYPE_KEY = HR_FACT_EMPLOYEE.EMP_TYPE_KEY
left join HR_DIM_EMP_LINE_GROUP       on HR_DIM_EMP_LINE_GROUP.EMP_LINE_GROUP_KEY = HR_FACT_EMPLOYEE.EMP_LINE_KEY
group by 
 HR_DIM_POSITION_GROUP.POSITION_GROUP_CODE
, HR_DIM_POSITION_GROUP.POSITION_GROUP_NAME
)Pos
where POSITION_GROUP_CODE !=  '3'
order by nos,POSITION_GROUP_CODE				
				
	;
		
    OPEN result_set_1;
END
CREATE PROCEDURE emp_paramTypeLineIsm(IN paramPos VARCHAR(256)) 
DYNAMIC RESULT SETS 1 
LANGUAGE SQL 
BEGIN 
    DECLARE result_set_1 CURSOR WITH RETURN TO CLIENT FOR

select TypeLineCode
,TypeLineName
,POSITION_GROUP_CODE
,POSITION_GROUP_NAME
from
(
SELECT 'All' as TypeLineCode
,'รวม' as TypeLineName
,'All' as POSITION_GROUP_CODE
,'รวม'  as POSITION_GROUP_NAME
, '2' as nos
from sysibm.sysdummy1

union

select TypeLineCode
,TypeLineName
,POSITION_GROUP_CODE
,POSITION_GROUP_NAME
,nos
from 
(
SELECT HR_DIM_EMP_TYPE.EMP_TYPE_GROUP_CODE || HR_DIM_EMP_LINE_GROUP.EMP_LINE_GROUP_CODE as TypeLineCode
, HR_DIM_EMP_TYPE.EMP_TYPE_GROUP_NAME ||' - '|| HR_DIM_EMP_LINE_GROUP.EMP_LINE_GROUP_NAME as TypeLineName
, HR_DIM_POSITION_GROUP.POSITION_GROUP_CODE
, HR_DIM_POSITION_GROUP.POSITION_GROUP_NAME
, '1' as nos
FROM HR_FACT_EMPLOYEE
left join HR_DIM_POSITION_GROUP on HR_DIM_POSITION_GROUP.POSITION_GROUP_KEY = HR_FACT_EMPLOYEE.POSITION_GROUP_KEY
left join HR_DIM_EMP_TYPE       on HR_DIM_EMP_TYPE.EMP_TYPE_KEY = HR_FACT_EMPLOYEE.EMP_TYPE_KEY
left join HR_DIM_EMP_LINE_GROUP on HR_DIM_EMP_LINE_GROUP.EMP_LINE_GROUP_KEY = HR_FACT_EMPLOYEE.EMP_LINE_KEY

where POSITION_GROUP_CODE !=  '3'
group by  HR_DIM_POSITION_GROUP.POSITION_GROUP_CODE
, HR_DIM_POSITION_GROUP.POSITION_GROUP_NAME
, HR_DIM_EMP_TYPE.EMP_TYPE_GROUP_CODE || HR_DIM_EMP_LINE_GROUP.EMP_LINE_GROUP_CODE
, HR_DIM_EMP_TYPE.EMP_TYPE_GROUP_NAME ||' - '|| HR_DIM_EMP_LINE_GROUP.EMP_LINE_GROUP_NAME
)TypeLine
where (POSITION_GROUP_CODE in (paramPos) or 'All' in (paramPos))
)gj
order by nos,POSITION_GROUP_CODE

	;
		
    OPEN result_set_1;
END
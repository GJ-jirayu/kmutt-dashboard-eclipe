--  ผู้สำเร็จ_กราฟ 1.1 (กราฟแท่ง) p_graduate_by_faculty_and_education_level (ให้เปลี่ยนมาใช้ field education_level แทน education_level_group)
select DIM_FIELD.FACULTY_NAME,EDUCATION_LEVEL_GROUP,sum(no_of_graduate) as TotalGraduate
from fact_graduate
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = fact_graduate.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = fact_graduate.PROGRAM_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = fact_graduate.FIELD_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001')
group by DIM_SEMESTER.ACADEMIC_YEAR,DIM_FIELD.FACULTY_NAME,EDUCATION_LEVEL_GROUP
order by DIM_SEMESTER.ACADEMIC_YEAR,DIM_FIELD.FACULTY_NAME,EDUCATION_LEVEL_GROUP asc

--  ผู้สำเร็จ_กราฟ 1.2(กราฟวงกลม) p_graduate_by_faculty
select DIM_FIELD.FACULTY_NAME,sum(no_of_graduate) as TotalGraduate
from fact_graduate
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = fact_graduate.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = fact_graduate.PROGRAM_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = fact_graduate.FIELD_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001')
group by DIM_SEMESTER.ACADEMIC_YEAR,DIM_FIELD.FACULTY_NAME
order by DIM_SEMESTER.ACADEMIC_YEAR,DIM_FIELD.FACULTY_NAME asc

--  ผู้สำเร็จ_กราฟ 1.3 (กราฟเส้น) p_graduate_by_year_and_education_level
select DIM_SEMESTER.ACADEMIC_YEAR,EDUCATION_LEVEL_GROUP,sum(no_of_graduate) as TotalGraduate
from fact_graduate
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = fact_graduate.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = fact_graduate.PROGRAM_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = fact_graduate.FIELD_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001')
group by DIM_SEMESTER.ACADEMIC_YEAR,EDUCATION_LEVEL_GROUP
order by DIM_SEMESTER.ACADEMIC_YEAR,EDUCATION_LEVEL_GROUP asc

--  ผู้สำเร็จ_กราฟ 2.1 (กราฟแท่งเส้น) p_graduate_vs_plan_by_year
select ACADEMIC_YEAR,ACTUALPLANTYPE,TOTELACTUALPLAN
from(
SELECT DIM_SEMESTER.ACADEMIC_YEAR 
,'ผู้สำเร็จการศึกษา' as ACTUALPLANTYPE
,sum(FACT_ACTUAL_PLAN.NO_OF_ACTUAL_GRADUATE) as TOTELACTUALPLAN
FROM FACT_ACTUAL_PLAN
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ACTUAL_PLAN.SEMESTER_KEY
left join DIM_EDUCATION_LEVEL on DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_KEY = FACT_ACTUAL_PLAN.EDUCATION_LEVEL_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_CODE in ('001')
group by DIM_SEMESTER.ACADEMIC_YEAR

union

SELECT DIM_SEMESTER.ACADEMIC_YEAR 
,'แผน' as ACTUALPLANTYPE
,sum(FACT_ACTUAL_PLAN.NO_OF_PLAN_GRADUATE) as TOTELACTUALPLAN
FROM FACT_ACTUAL_PLAN
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ACTUAL_PLAN.SEMESTER_KEY
left join DIM_EDUCATION_LEVEL on DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_KEY = FACT_ACTUAL_PLAN.EDUCATION_LEVEL_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_CODE in ('001')
group by DIM_SEMESTER.ACADEMIC_YEAR
)ACTUAL_PLAN
order by ACADEMIC_YEAR,ACTUALPLANTYPE asc

--  ผู้สำเร็จ_กราฟ 2.2 (กราฟแท่งเส้น) p_graduate_by_study_time
select DIM_STUDY_TIME.STUDY_TIME,sum(no_of_graduate) as TotalGraduate
from fact_graduate
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = fact_graduate.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = fact_graduate.PROGRAM_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = fact_graduate.FIELD_KEY
left join DIM_STUDY_TIME on DIM_STUDY_TIME.STUDY_TIME_KEY = fact_graduate.STUDY_TIME_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001')
group by DIM_SEMESTER.ACADEMIC_YEAR,DIM_STUDY_TIME.STUDY_TIME
order by DIM_SEMESTER.ACADEMIC_YEAR,DIM_STUDY_TIME.STUDY_TIME asc

--  ผู้สำเร็จ_กราฟ 2.3 (กราฟแท่งเส้น) p_graduate_vs_plan_by_faculty
select FACULTY_NAME,ACTUALPLANTYPE,TOTELACTUALPLAN
from(
SELECT DIM_FIELD.FACULTY_NAME
,'ผู้สำเร็จการศึกษา' as ACTUALPLANTYPE
,sum(FACT_ACTUAL_PLAN.NO_OF_ACTUAL_GRADUATE) as TOTELACTUALPLAN
FROM FACT_ACTUAL_PLAN
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ACTUAL_PLAN.SEMESTER_KEY
left join DIM_EDUCATION_LEVEL on DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_KEY = FACT_ACTUAL_PLAN.EDUCATION_LEVEL_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_ACTUAL_PLAN.FIELD_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_CODE in ('001')
group by DIM_SEMESTER.ACADEMIC_YEAR,DIM_FIELD.FACULTY_NAME

union

SELECT DIM_FIELD.FACULTY_NAME
,'แผน' as ACTUALPLANTYPE
,sum(FACT_ACTUAL_PLAN.NO_OF_PLAN_GRADUATE) as TOTELACTUALPLAN
FROM FACT_ACTUAL_PLAN
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ACTUAL_PLAN.SEMESTER_KEY
left join DIM_EDUCATION_LEVEL on DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_KEY = FACT_ACTUAL_PLAN.EDUCATION_LEVEL_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_ACTUAL_PLAN.FIELD_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_CODE in ('001')
group by DIM_SEMESTER.ACADEMIC_YEAR,DIM_FIELD.FACULTY_NAME
)ACTUAL_PLAN
order by ACADEMIC_YEAR,ACTUALPLANTYPE asc

--  ผู้สำเร็จ_กราฟ 3.1 (กราฟเส้น) p_graduate_work_by_year ต้อง sum(no_of_employ), sum(no_of_unemploy), sum(no_of_study) ด้วยครับ
SELECT academic_year,
no_of_employ
no_of_unemploy
no_of_study
from fact_graduate_work
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and and DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_CODE in ('001')

--  ผู้สำเร็จ_กราฟ 3.2 (กราฟเส้น) p_graduate_work_by_faculty

-- 3.3 p_employer_survey_by_faculty

--  นักศึกษาทั้ง_กราฟ 1.1 (กราฟแท่งกับเส้น) p_all_student_vs_plan_by_year
select ACADEMIC_YEAR,ACTUALPLANTYPE,TOTELACTUALPLAN
from(
SELECT DIM_SEMESTER.ACADEMIC_YEAR 
,'นักศึกษาท้ังหมด' as ACTUALPLANTYPE
,sum(FACT_ACTUAL_PLAN.NO_OF_ACTUAL_STUDENT) as TOTELACTUALPLAN
FROM FACT_ACTUAL_PLAN
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ACTUAL_PLAN.SEMESTER_KEY
left join DIM_EDUCATION_LEVEL on DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_KEY = FACT_ACTUAL_PLAN.EDUCATION_LEVEL_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_CODE in ('001')
group by DIM_SEMESTER.ACADEMIC_YEAR

union

SELECT DIM_SEMESTER.ACADEMIC_YEAR 
,'แผน' as ACTUALPLANTYPE
,sum(FACT_ACTUAL_PLAN.NO_OF_PLAN_STUDENT) as TOTELACTUALPLAN
FROM FACT_ACTUAL_PLAN
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ACTUAL_PLAN.SEMESTER_KEY
left join DIM_EDUCATION_LEVEL on DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_KEY = FACT_ACTUAL_PLAN.EDUCATION_LEVEL_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_CODE in ('001')
group by DIM_SEMESTER.ACADEMIC_YEAR
)ACTUAL_PLAN
order by ACADEMIC_YEAR,ACTUALPLANTYPE asc

--  นักศึกษาทั้ง_กราฟ 1.2 (กราฟแท่ง) p_all_student_by_education_level_and_student_type
--  นักศึกษาทั้ง_กราฟ 1.3 (กราฟแท่งกับเส้น)  p_all_student_vs_plan_by_faculty
SELECT DIM_SEMESTER.ACADEMIC_YEAR
,DIM_FIELD.FACULTY_NAME
,'นักศึกษาท้ังหมด' as ACTUALPLANTYPE
,sum(FACT_ACTUAL_PLAN.NO_OF_ACTUAL_STUDENT) as TOTELACTUALPLAN
,'แผน' as ACTUALPLANTYPE
,sum(FACT_ACTUAL_PLAN.NO_OF_PLAN_STUDENT) as TOTELACTUALPLAN
FROM FACT_ACTUAL_PLAN
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ACTUAL_PLAN.SEMESTER_KEY
left join DIM_EDUCATION_LEVEL on DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_KEY = FACT_ACTUAL_PLAN.EDUCATION_LEVEL_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_ACTUAL_PLAN.FIELD_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
and DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_CODE in ('001')
group by DIM_SEMESTER.ACADEMIC_YEAR,DIM_FIELD.FACULTY_NAME
order by DIM_SEMESTER.ACADEMIC_YEAR,DIM_FIELD.FACULTY_NAME asc

--  นักศึกษาทั้ง_กราฟ 2.1 (กราฟแท่ง) p_all_student_by_year_and_arrange_type
select DIM_SEMESTER.ACADEMIC_YEAR,DIM_PROGRAM.ARRANGE_TYPE,sum(no_of_student) as no_of_student
from FACT_ALL_STUDENT 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ALL_STUDENT.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ALL_STUDENT.PROGRAM_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001')
group by DIM_SEMESTER.ACADEMIC_YEAR,DIM_PROGRAM.ARRANGE_TYPE
order by DIM_SEMESTER.ACADEMIC_YEAR,DIM_PROGRAM.ARRANGE_TYPE asc

--  นักศึกษาทั้ง_กราฟ 2.2 (กราฟแท่ง) p_all_student_by_faculty_and_arrange_type
select DIM_FIELD.FACULTY_NAME,DIM_PROGRAM.ARRANGE_TYPE,sum(no_of_student) as no_of_student
from FACT_ALL_STUDENT 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ALL_STUDENT.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ALL_STUDENT.PROGRAM_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_ALL_STUDENT.FIELD_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001')
group by DIM_FIELD.FACULTY_NAME,DIM_PROGRAM.ARRANGE_TYPE
ORDER BY DIM_FIELD.FACULTY_NAME,DIM_PROGRAM.ARRANGE_TYPE asc

--  นักศึกษาทั้ง_กราฟ 3.1 (กราฟแท่ง) p_all_student_by_year_and_fee_type
select DIM_SEMESTER.ACADEMIC_YEAR,DIM_PROGRAM.FEE_TYPE,sum(no_of_student) as no_of_student
from FACT_ALL_STUDENT 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ALL_STUDENT.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ALL_STUDENT.PROGRAM_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001')
group by DIM_SEMESTER.ACADEMIC_YEAR,DIM_PROGRAM.FEE_TYPE
order by DIM_SEMESTER.ACADEMIC_YEAR,DIM_PROGRAM.FEE_TYPE asc

--  นักศึกษาทั้ง_กราฟ 3.2 (กราฟแท่ง) p_all_student_by_faculty_and_fee_type
select DIM_FIELD.FACULTY_NAME,DIM_PROGRAM.FEE_TYPE,sum(no_of_student) as no_of_student
from FACT_ALL_STUDENT 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ALL_STUDENT.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ALL_STUDENT.PROGRAM_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_ALL_STUDENT.FIELD_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001')
group by DIM_FIELD.FACULTY_NAME,DIM_PROGRAM.FEE_TYPE 
order by DIM_FIELD.FACULTY_NAME,DIM_PROGRAM.FEE_TYPE  asc

--  นักศึกษาทั้ง_กราฟ 4.1 (กราฟแท่ง) p_all_student_by_year_and_schedule_type
select DIM_SEMESTER.ACADEMIC_YEAR,DIM_SCHEDULE_PLAN.SCHEDULE_TYPE_NAME,sum(no_of_student) as no_of_student
from FACT_ALL_STUDENT 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ALL_STUDENT.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ALL_STUDENT.PROGRAM_KEY
left join DIM_SCHEDULE_PLAN on DIM_SCHEDULE_PLAN.SCHEDULE_PLAN_KEY = FACT_ALL_STUDENT.SCHEDULE_PLAN_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001')
group by DIM_SEMESTER.ACADEMIC_YEAR,DIM_SCHEDULE_PLAN.SCHEDULE_TYPE_NAME
order by DIM_SEMESTER.ACADEMIC_YEAR,DIM_SCHEDULE_PLAN.SCHEDULE_TYPE_NAME asc

--  นักศึกษาทั้ง_กราฟ 4.2 (กราฟแท่ง) p_all_student_by_faculty_and_schedule_type
select DIM_FIELD.FACULTY_NAME,DIM_SCHEDULE_PLAN.SCHEDULE_TYPE_NAME,sum(no_of_student) as no_of_student
from FACT_ALL_STUDENT 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ALL_STUDENT.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ALL_STUDENT.PROGRAM_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_ALL_STUDENT.FIELD_KEY
left join DIM_SCHEDULE_PLAN on DIM_SCHEDULE_PLAN.SCHEDULE_PLAN_KEY = FACT_ALL_STUDENT.SCHEDULE_PLAN_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001')
group by DIM_SEMESTER.ACADEMIC_YEAR,DIM_FIELD.FACULTY_NAME,DIM_SCHEDULE_PLAN.SCHEDULE_TYPE_NAME 
order by DIM_SEMESTER.ACADEMIC_YEAR,DIM_FIELD.FACULTY_NAME,DIM_SCHEDULE_PLAN.SCHEDULE_TYPE_NAME  asc

--  นักศึกษาทั้ง_กราฟ 4.3 (กราฟวงกลม) p_all_student_by_schedule_type
select DIM_SCHEDULE_PLAN.SCHEDULE_TYPE_NAME,sum(no_of_student) as no_of_student
from FACT_ALL_STUDENT 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ALL_STUDENT.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ALL_STUDENT.PROGRAM_KEY
left join DIM_SCHEDULE_PLAN on DIM_SCHEDULE_PLAN.SCHEDULE_PLAN_KEY = FACT_ALL_STUDENT.SCHEDULE_PLAN_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001')
group by DIM_SEMESTER.ACADEMIC_YEAR,DIM_SCHEDULE_PLAN.SCHEDULE_TYPE_NAME
order by DIM_SCHEDULE_PLAN.SCHEDULE_TYPE_NAME asc

--  นักศึกษาทั้ง_กราฟ 5.1 (กราฟเส้น) p_teacher_per_ftes_by_year
select DIM_SEMESTER.ACADEMIC_YEAR,'สัดส่วนอาจารย์ประจำต่อ FTES' as teacher,sum(no_of_student_ftes) as no_of_student_ftes
from fact_teacher_student 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = fact_teacher_student.SEMESTER_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
group by DIM_SEMESTER.ACADEMIC_YEAR 
order by DIM_SEMESTER.ACADEMIC_YEAR  asc

--  นักศึกษาทั้ง_กราฟ 5.2 (กราฟเส้น) p_teacher_per_ftes_by_faculty
select DIM_FACULTY.FACULTY_NAME,'สัดส่วนอาจารย์ประจำต่อ FTES' as teacher,sum(no_of_student_ftes) as no_of_student_ftes
from fact_teacher_student 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = fact_teacher_student.SEMESTER_KEY
left join DIM_FACULTY on DIM_FACULTY.faculty_key = fact_teacher_student.faculty_key
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
group by DIM_SEMESTER.ACADEMIC_YEAR,DIM_FACULTY.FACULTY_NAME

--  นักศึกษาทั้ง_กราฟ 5.3 (กราฟตาราง) p_teacher_ftes_by_year
select ACADEMIC_YEAR , teacher , TOTEL_FTES
from
(select DIM_SEMESTER.ACADEMIC_YEAR,'จำนวน นศ.เต็มเวลา (FTES)' as teacher,sum(no_of_student_ftes) as TOTEL_FTES
from fact_teacher_student 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = fact_teacher_student.SEMESTER_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
group by DIM_SEMESTER.ACADEMIC_YEAR 
union
select DIM_SEMESTER.ACADEMIC_YEAR,'สัดส่วนอาจารย์ต่อ (FTES)' as teacher,sum(no_of_teacher) as TOTEL_FTES
from fact_teacher_student 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = fact_teacher_student.SEMESTER_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
group by DIM_SEMESTER.ACADEMIC_YEAR 
union
select DIM_SEMESTER.ACADEMIC_YEAR,'จำนวน นศ.เต็มเวลา (FTES)/สัดส่วนอาจารย์ต่อ (FTES)' as teacher,sum(no_of_student_ftes/no_of_teacher) as TOTEL_FTES
from fact_teacher_student 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = fact_teacher_student.SEMESTER_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_SEMESTER.SEMESTER_CODE in ('1')
group by DIM_SEMESTER.ACADEMIC_YEAR 
)teacher_student
order by ACADEMIC_YEAR asc

--  นักศึกษาทั้ง_กราฟ 6.1 (กราฟตาราง) p_inbound_outbound_per_all_student
select ACADEMIC_YEAR , StudentsType , ToTal_no_of_student
from
(
select DIM_SEMESTER.ACADEMIC_YEAR,'ToTal Students' as StudentsType,sum(no_of_student) as ToTal_no_of_student
from FACT_ALL_STUDENT 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ALL_STUDENT.SEMESTER_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_ALL_STUDENT.FIELD_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_FIELD.FACULTY_CODE in ('10900000')
and DIM_FIELD.DEPARTMENT_CODE in ('10902000')
group by DIM_SEMESTER.ACADEMIC_YEAR
union 
select DIM_SEMESTER.ACADEMIC_YEAR,'Inbound' as StudentsType,'0' as ToTal_no_of_student
from FACT_ALL_STUDENT 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ALL_STUDENT.SEMESTER_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_ALL_STUDENT.FIELD_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_FIELD.FACULTY_CODE in ('10900000')
and DIM_FIELD.DEPARTMENT_CODE in ('10902000')
group by DIM_SEMESTER.ACADEMIC_YEAR
union
select DIM_SEMESTER.ACADEMIC_YEAR,'Outbound' as StudentsType,'0' as ToTal_no_of_student
from FACT_ALL_STUDENT 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ALL_STUDENT.SEMESTER_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_ALL_STUDENT.FIELD_KEY
where DIM_SEMESTER.ACADEMIC_YEAR in ('2556')
and DIM_FIELD.FACULTY_CODE in ('10900000')
and DIM_FIELD.DEPARTMENT_CODE in ('10902000')
group by DIM_SEMESTER.ACADEMIC_YEAR
)ALL_STUDENT 
order by ACADEMIC_YEAR
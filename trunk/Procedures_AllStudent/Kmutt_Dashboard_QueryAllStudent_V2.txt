--  นักศึกษาทั้ง_กราฟ 1.1 (กราฟแท่งกับเส้น) p_all_student_vs_plan_by_year
select ACADEMIC_YEAR,ACTUALPLANTYPE,TOTELACTUALPLAN
from(
SELECT DIM_SEMESTER.ACADEMIC_YEAR 
,'นักศึกษาท้ังหมด' as ACTUALPLANTYPE
,sum(FACT_ACTUAL_PLAN.NO_OF_ACTUAL_STUDENT) as TOTELACTUALPLAN
FROM FACT_ACTUAL_PLAN
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ACTUAL_PLAN.SEMESTER_KEY
left join DIM_EDUCATION_LEVEL on DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_KEY = FACT_ACTUAL_PLAN.EDUCATION_LEVEL_KEY
left join DIM_FOREIGN_FLAG on DIM_FOREIGN_FLAG.FOREIGN_FLAG_KEY = FACT_ACTUAL_PLAN.FOREIGN_FLAG_KEY
where (DIM_SEMESTER.ACADEMIC_YEAR between ('2556')-('3')+(1) and ('2556'))
and (DIM_SEMESTER.SEMESTER_CODE in ('1'))
and (DIM_FOREIGN_FLAG.FOREIGN_FLAG in ('N'))
and (DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_CODE in ('001'))
group by DIM_SEMESTER.ACADEMIC_YEAR

union

SELECT DIM_SEMESTER.ACADEMIC_YEAR 
,'แผน' as ACTUALPLANTYPE
,sum(FACT_ACTUAL_PLAN.NO_OF_PLAN_STUDENT) as TOTELACTUALPLAN
FROM FACT_ACTUAL_PLAN
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ACTUAL_PLAN.SEMESTER_KEY
left join DIM_EDUCATION_LEVEL on DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_KEY = FACT_ACTUAL_PLAN.EDUCATION_LEVEL_KEY
left join DIM_FOREIGN_FLAG on DIM_FOREIGN_FLAG.FOREIGN_FLAG_KEY = FACT_ACTUAL_PLAN.FOREIGN_FLAG_KEY
where (DIM_SEMESTER.ACADEMIC_YEAR between ('2556')-('3')+(1) and ('2556'))
and (DIM_SEMESTER.SEMESTER_CODE in ('1'))
and (DIM_FOREIGN_FLAG.FOREIGN_FLAG in ('N'))
and (DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_CODE in ('001'))
group by DIM_SEMESTER.ACADEMIC_YEAR
)ACTUAL_PLAN
order by ACTUALPLANTYPE,ACADEMIC_YEAR asc

--  นักศึกษาทั้ง_กราฟ 1.2 (กราฟแท่ง) p_all_student_by_education_level_and_student_type
select EDUCATION_LEVEL
,FOREIGN
,Total_NO_OF_STUDENT
from
(
SELECT EDUCATION_LEVEL_CODE
,EDUCATION_LEVEL
,FOREIGN_FLAG
,'นักศึกษาไทย'  as FOREIGN
,sum(NO_OF_STUDENT) as Total_NO_OF_STUDENT

FROM FACT_ALL_STUDENT
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ALL_STUDENT.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ALL_STUDENT.PROGRAM_KEY
left join DIM_FOREIGN_FLAG on DIM_FOREIGN_FLAG.FOREIGN_FLAG_KEY = FACT_ALL_STUDENT.FOREIGN_FLAG_KEY
where (DIM_FOREIGN_FLAG.FOREIGN_FLAG in ('N'))
and (DIM_SEMESTER.ACADEMIC_YEAR in (2556))
and (DIM_SEMESTER.SEMESTER_CODE in ('1'))
and (DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001'))
group by EDUCATION_LEVEL_CODE
,EDUCATION_LEVEL
,FOREIGN_FLAG

union

SELECT EDUCATION_LEVEL_CODE
,EDUCATION_LEVEL
,FOREIGN_FLAG
,'นักศึกษาต่างชาติ'  as FOREIGN
,sum(NO_OF_STUDENT) as Total_NO_OF_STUDENT
FROM FACT_ALL_STUDENT
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ALL_STUDENT.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ALL_STUDENT.PROGRAM_KEY
left join DIM_FOREIGN_FLAG on DIM_FOREIGN_FLAG.FOREIGN_FLAG_KEY = FACT_ALL_STUDENT.FOREIGN_FLAG_KEY
where (DIM_FOREIGN_FLAG.FOREIGN_FLAG in ('Y'))
and (DIM_SEMESTER.ACADEMIC_YEAR in (2556))
and (DIM_SEMESTER.SEMESTER_CODE in ('1'))
and (DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001'))
group by EDUCATION_LEVEL_CODE
,EDUCATION_LEVEL
,FOREIGN_FLAG
)gj
where (FOREIGN_FLAG in ('Y'))
order by FOREIGN_FLAG,EDUCATION_LEVEL_CODE

--  นักศึกษาทั้ง_กราฟ 1.3 (กราฟแท่งกับเส้น)  p_all_student_vs_plan_by_faculty
select FACULTY_NAME_INITIAL ,ACTUALPLANTYPE, TOTELACTUALPLAN
from
(
SELECT DIM_FACULTY.FACULTY_CODE
,DIM_FACULTY.FACULTY_NAME_INITIAL
,'นักศึกษาท้ังหมด' as ACTUALPLANTYPE
,sum(FACT_ACTUAL_PLAN.NO_OF_ACTUAL_STUDENT) as TOTELACTUALPLAN
FROM FACT_ACTUAL_PLAN
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ACTUAL_PLAN.SEMESTER_KEY
left join DIM_EDUCATION_LEVEL on DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_KEY = FACT_ACTUAL_PLAN.EDUCATION_LEVEL_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_ACTUAL_PLAN.FIELD_KEY
left join DIM_FOREIGN_FLAG on DIM_FOREIGN_FLAG.FOREIGN_FLAG_KEY = FACT_ACTUAL_PLAN.FOREIGN_FLAG_KEY
left join DIM_FACULTY on DIM_FACULTY.FACULTY_CODE = DIM_FIELD.FACULTY_CODE
where (DIM_SEMESTER.ACADEMIC_YEAR in (2556))
and (DIM_SEMESTER.SEMESTER_CODE in ('1'))
and (DIM_FOREIGN_FLAG.FOREIGN_FLAG in ('N'))
and (DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_CODE in ('001'))
group by DIM_SEMESTER.ACADEMIC_YEAR
,DIM_FACULTY.FACULTY_CODE
,DIM_FACULTY.FACULTY_NAME_INITIAL
union
SELECT DIM_FACULTY.FACULTY_CODE
,DIM_FACULTY.FACULTY_NAME_INITIAL
,'แผน' as ACTUALPLANTYPE
,sum(FACT_ACTUAL_PLAN.NO_OF_PLAN_STUDENT) as TOTELACTUALPLAN
FROM FACT_ACTUAL_PLAN
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ACTUAL_PLAN.SEMESTER_KEY
left join DIM_EDUCATION_LEVEL on DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_KEY = FACT_ACTUAL_PLAN.EDUCATION_LEVEL_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_ACTUAL_PLAN.FIELD_KEY
left join DIM_FOREIGN_FLAG on DIM_FOREIGN_FLAG.FOREIGN_FLAG_KEY = FACT_ACTUAL_PLAN.FOREIGN_FLAG_KEY
left join DIM_FACULTY on DIM_FACULTY.FACULTY_CODE = DIM_FIELD.FACULTY_CODE
where (DIM_SEMESTER.ACADEMIC_YEAR in (2556))
and (DIM_SEMESTER.SEMESTER_CODE in ('1'))
and (DIM_FOREIGN_FLAG.FOREIGN_FLAG in ('N'))
and (DIM_EDUCATION_LEVEL.EDUCATION_LEVEL_CODE in ('001'))
group by DIM_SEMESTER.ACADEMIC_YEAR
,DIM_FACULTY.FACULTY_CODE
,DIM_FACULTY.FACULTY_NAME_INITIAL
)ACTUAL_PLAN
order by ACTUALPLANTYPE,FACULTY_CODE;


--  นักศึกษาทั้ง_กราฟ 2.1 (กราฟแท่ง) p_all_student_by_year_and_arrange_type
select DIM_SEMESTER.ACADEMIC_YEAR,DIM_PROGRAM.ARRANGE_TYPE,sum(no_of_student) as no_of_student
from FACT_ALL_STUDENT 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ALL_STUDENT.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ALL_STUDENT.PROGRAM_KEY
where (DIM_SEMESTER.ACADEMIC_YEAR between ('2556')-('3') and ('2556'))
and (DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001'))
group by DIM_SEMESTER.ACADEMIC_YEAR,DIM_PROGRAM.ARRANGE_TYPE
order by DIM_PROGRAM.ARRANGE_TYPE,DIM_SEMESTER.ACADEMIC_YEAR asc


--  นักศึกษาทั้ง_กราฟ 2.2 (กราฟแท่ง) p_all_student_by_faculty_and_arrange_type
select gj.FACULTY_NAME_INITIAL
,gj.ARRANGE_TYPE
,DECIMAL(((DECIMAL(gj.no_of_student,8,2) * 100)/gj2.of_student),8,2) as Totale_student
from
(
select DIM_FACULTY.FACULTY_CODE
,DIM_FACULTY.FACULTY_NAME_INITIAL
,DIM_PROGRAM.ARRANGE_TYPE
,sum(no_of_student) as no_of_student
from FACT_ALL_STUDENT 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ALL_STUDENT.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ALL_STUDENT.PROGRAM_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_ALL_STUDENT.FIELD_KEY
left join DIM_FACULTY on DIM_FACULTY.FACULTY_CODE = DIM_FIELD.FACULTY_CODE
where (DIM_SEMESTER.ACADEMIC_YEAR in ('2556'))
and (DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001'))
group by DIM_FACULTY.FACULTY_CODE
,DIM_FACULTY.FACULTY_NAME_INITIAL
,DIM_PROGRAM.ARRANGE_TYPE
)gj
left join (

select DIM_FACULTY.FACULTY_CODE
,sum(no_of_student) as of_student
from FACT_ALL_STUDENT 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ALL_STUDENT.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ALL_STUDENT.PROGRAM_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_ALL_STUDENT.FIELD_KEY
left join DIM_FACULTY on DIM_FACULTY.FACULTY_CODE = DIM_FIELD.FACULTY_CODE
where (DIM_SEMESTER.ACADEMIC_YEAR in ('2556'))
and (DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001'))
group by DIM_FACULTY.FACULTY_CODE

)gj2 on gj2.FACULTY_CODE = gj.FACULTY_CODE
order by gj.ARRANGE_TYPE,gj.FACULTY_CODE




--  นักศึกษาทั้ง_กราฟ 3.1 (กราฟแท่ง) p_all_student_by_year_and_fee_type
select DIM_SEMESTER.ACADEMIC_YEAR,DIM_PROGRAM.FEE_TYPE,sum(no_of_student) as no_of_student
from FACT_ALL_STUDENT 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ALL_STUDENT.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ALL_STUDENT.PROGRAM_KEY
where (DIM_SEMESTER.ACADEMIC_YEAR between ('2556')-('3') and ('2556'))
and (DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001'))
group by DIM_SEMESTER.ACADEMIC_YEAR,DIM_PROGRAM.FEE_TYPE
order by DIM_PROGRAM.FEE_TYPE,DIM_SEMESTER.ACADEMIC_YEAR asc

--  นักศึกษาทั้ง_กราฟ 3.2 (กราฟแท่ง) p_all_student_by_faculty_and_fee_type
select gj.FACULTY_NAME_INITIAL
,gj.FEE_TYPE
,DECIMAL(((DECIMAL(gj.no_of_student,8,2) * 100)/gj2.no_student),8,2) as Totale_student
from
(select DIM_FACULTY.FACULTY_CODE
,DIM_FACULTY.FACULTY_NAME_INITIAL
,DIM_PROGRAM.FEE_TYPE
,sum(no_of_student) as no_of_student
from FACT_ALL_STUDENT 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ALL_STUDENT.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ALL_STUDENT.PROGRAM_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_ALL_STUDENT.FIELD_KEY
left join DIM_FACULTY on DIM_FACULTY.FACULTY_CODE = DIM_FIELD.FACULTY_CODE
where (DIM_SEMESTER.ACADEMIC_YEAR in ('2556'))
-- and (DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001'))
group by DIM_FACULTY.FACULTY_CODE
,DIM_FACULTY.FACULTY_NAME_INITIAL
,DIM_PROGRAM.FEE_TYPE
)gj
left join (
	select DIM_FACULTY.FACULTY_CODE
,sum(no_of_student) as no_student
from FACT_ALL_STUDENT 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ALL_STUDENT.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ALL_STUDENT.PROGRAM_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_ALL_STUDENT.FIELD_KEY
left join DIM_FACULTY on DIM_FACULTY.FACULTY_CODE = DIM_FIELD.FACULTY_CODE
where (DIM_SEMESTER.ACADEMIC_YEAR in ('2556'))
-- and (DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001'))
group by DIM_FACULTY.FACULTY_CODE
)gj2 on gj2.FACULTY_CODE = gj.FACULTY_CODE
where gj.no_of_student not in ('0')
order by gj.FEE_TYPE,gj.FACULTY_CODE

--  นักศึกษาทั้ง_กราฟ 4.1 (กราฟแท่ง) p_all_student_by_year_and_schedule_type
select DIM_SEMESTER.ACADEMIC_YEAR,DIM_SCHEDULE_PLAN.SCHEDULE_TYPE_NAME,sum(no_of_student) as no_of_student
from FACT_ALL_STUDENT 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ALL_STUDENT.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ALL_STUDENT.PROGRAM_KEY
left join DIM_SCHEDULE_PLAN on DIM_SCHEDULE_PLAN.SCHEDULE_PLAN_KEY = FACT_ALL_STUDENT.SCHEDULE_PLAN_KEY
where (DIM_SEMESTER.ACADEMIC_YEAR between ('2556')-('3') and ('2556'))
and (DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001'))
group by DIM_SEMESTER.ACADEMIC_YEAR,DIM_SCHEDULE_PLAN.SCHEDULE_TYPE_NAME
order by DIM_SCHEDULE_PLAN.SCHEDULE_TYPE_NAME,DIM_SEMESTER.ACADEMIC_YEAR asc

--  นักศึกษาทั้ง_กราฟ 4.2 (กราฟแท่ง) p_all_student_by_faculty_and_schedule_type
select gj.FACULTY_NAME_INITIAL
,gj.SCHEDULE_TYPE_NAME
,DECIMAL(((DECIMAL(gj.no_of_student,8,2) * 100)/gj2.no_student),8,2) as Totale_student
from
(select DIM_FACULTY.FACULTY_CODE
,DIM_FACULTY.FACULTY_NAME_INITIAL
,DIM_SCHEDULE_PLAN.SCHEDULE_TYPE_NAME
,sum(no_of_student) as no_of_student
from FACT_ALL_STUDENT 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ALL_STUDENT.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ALL_STUDENT.PROGRAM_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_ALL_STUDENT.FIELD_KEY
left join DIM_SCHEDULE_PLAN on DIM_SCHEDULE_PLAN.SCHEDULE_PLAN_KEY = FACT_ALL_STUDENT.SCHEDULE_PLAN_KEY
left join DIM_FACULTY on DIM_FACULTY.FACULTY_CODE = DIM_FIELD.FACULTY_CODE
where (DIM_SEMESTER.ACADEMIC_YEAR in (2556))
and (DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001'))
group by DIM_FACULTY.FACULTY_CODE
,DIM_FACULTY.FACULTY_NAME_INITIAL
,DIM_SCHEDULE_PLAN.SCHEDULE_TYPE_NAME
)gj 
left join (
select DIM_FACULTY.FACULTY_CODE
,sum(no_of_student) as no_student
from FACT_ALL_STUDENT 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ALL_STUDENT.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ALL_STUDENT.PROGRAM_KEY
left join DIM_FIELD on DIM_FIELD.FIELD_KEY = FACT_ALL_STUDENT.FIELD_KEY
left join DIM_SCHEDULE_PLAN on DIM_SCHEDULE_PLAN.SCHEDULE_PLAN_KEY = FACT_ALL_STUDENT.SCHEDULE_PLAN_KEY
left join DIM_FACULTY on DIM_FACULTY.FACULTY_CODE = DIM_FIELD.FACULTY_CODE
where (DIM_SEMESTER.ACADEMIC_YEAR in (2556))
and (DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001'))
group by DIM_FACULTY.FACULTY_CODE
)gj2 on gj2.FACULTY_CODE = gj.FACULTY_CODE
order by gj.SCHEDULE_TYPE_NAME,gj.FACULTY_CODE





--  นักศึกษาทั้ง_กราฟ 4.3 (กราฟวงกลม) p_all_student_by_schedule_type
select DIM_SCHEDULE_PLAN.SCHEDULE_TYPE_NAME,sum(no_of_student) as no_of_student
from FACT_ALL_STUDENT 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = FACT_ALL_STUDENT.SEMESTER_KEY
left join DIM_PROGRAM on DIM_PROGRAM.PROGRAM_KEY = FACT_ALL_STUDENT.PROGRAM_KEY
left join DIM_SCHEDULE_PLAN on DIM_SCHEDULE_PLAN.SCHEDULE_PLAN_KEY = FACT_ALL_STUDENT.SCHEDULE_PLAN_KEY
where (DIM_SEMESTER.ACADEMIC_YEAR in ('2556'))
and (DIM_PROGRAM.EDUCATION_LEVEL_CODE in ('001'))
group by DIM_SEMESTER.ACADEMIC_YEAR,DIM_SCHEDULE_PLAN.SCHEDULE_TYPE_NAME
order by DIM_SCHEDULE_PLAN.SCHEDULE_TYPE_NAME asc

--  นักศึกษาทั้ง_กราฟ 5.1 (กราฟเส้น) p_teacher_per_ftes_by_year
select ACADEMIC_YEAR
,teacher
,no_of_student/NO_OF_TEACHER as test
from
(
select DIM_SEMESTER.ACADEMIC_YEAR
,'สัดส่วนอาจารย์ประจำต่อ FTES' as teacher
,sum(no_of_student_ftes) as no_of_student
,sum(NO_OF_TEACHER) as NO_OF_TEACHER
from fact_teacher_student 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = fact_teacher_student.SEMESTER_KEY
where (DIM_SEMESTER.ACADEMIC_YEAR between ('2555')-('3')+('1') and ('2555'))
and (DIM_SEMESTER.SEMESTER_CODE in ('1'))
group by DIM_SEMESTER.ACADEMIC_YEAR 
)gj
order by teacher,ACADEMIC_YEAR


--  นักศึกษาทั้ง_กราฟ 5.2 (กราฟเส้น) p_teacher_per_ftes_by_faculty
select FACULTY_NAME_INITIAL
,teacher
,no_of_student/NO_OF_TEACHER as test
from
(
select DIM_FACULTY.FACULTY_CODE
,DIM_FACULTY.FACULTY_NAME_INITIAL
,'สัดส่วนอาจารย์ประจำต่อ FTES' as teacher
,sum(no_of_student_ftes) as no_of_student
,sum(NO_OF_TEACHER) as NO_OF_TEACHER
from fact_teacher_student 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = fact_teacher_student.SEMESTER_KEY
left join DIM_FACULTY on DIM_FACULTY.FACULTY_KEY = fact_teacher_student.FACULTY_KEY
where (DIM_SEMESTER.ACADEMIC_YEAR in ('2555'))
and (DIM_SEMESTER.SEMESTER_CODE in ('1'))
group by DIM_FACULTY.FACULTY_CODE
,DIM_FACULTY.FACULTY_NAME_INITIAL
)gj
order by teacher,gj.FACULTY_CODE

--  นักศึกษาทั้ง_กราฟ 5.3 (กราฟตาราง) p_teacher_ftes_by_year
select ACADEMIC_YEAR
,sum(TOTEL_FTES) as TOTEL_FTES
,sum(TOTEL_teacher) as TOTEL_teacher
,sum(TOTEL_teacherFTES) as TOTEL_teacherFTES
from
(
select DIM_SEMESTER.ACADEMIC_YEAR
,sum(no_of_student_ftes) as TOTEL_FTES
,'0' as TOTEL_teacher
,'0' as TOTEL_teacherFTES
from fact_teacher_student 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = fact_teacher_student.SEMESTER_KEY
where (DIM_SEMESTER.ACADEMIC_YEAR between (2555)-(3)+(1) and (2555))
and (DIM_SEMESTER.SEMESTER_CODE in ('1'))
group by DIM_SEMESTER.ACADEMIC_YEAR

union

select DIM_SEMESTER.ACADEMIC_YEAR
,'0' as TOTEL_FTES
,sum(no_of_teacher) as TOTEL_FTES
,'0' as TOTEL_teacherFTES
from fact_teacher_student 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = fact_teacher_student.SEMESTER_KEY
where (DIM_SEMESTER.ACADEMIC_YEAR between (2555)-(3)+(1) and (2555))
and (DIM_SEMESTER.SEMESTER_CODE in ('1'))
group by DIM_SEMESTER.ACADEMIC_YEAR

union
select DIM_SEMESTER.ACADEMIC_YEAR
,'0' as TOTEL_FTES
,'0' as TOTEL_FTES
,sum(no_of_student_ftes)/sum(no_of_teacher) as TOTEL_teacherFTES
from fact_teacher_student 
left join DIM_SEMESTER on DIM_SEMESTER.SEMESTER_KEY = fact_teacher_student.SEMESTER_KEY
where (DIM_SEMESTER.ACADEMIC_YEAR between (2555)-(3)+(1) and (2555))
and (DIM_SEMESTER.SEMESTER_CODE in ('1'))
group by DIM_SEMESTER.ACADEMIC_YEAR
)gj
group by ACADEMIC_YEAR
order by ACADEMIC_YEAR

--  นักศึกษาทั้ง_กราฟ 6.1 (กราฟตาราง) p_inbound_outbound_per_all_student
select INBOUND_OUTBOUND_STUDENT.ACADEMIC_YEAR
,INBOUND_OUTBOUND_STUDENT.TYPE
,sum(INBOUND_OUTBOUND_STUDENT.NO_OF_STUDENT) as TOTALSTUDENT
from INBOUND_OUTBOUND_STUDENT
where (INBOUND_OUTBOUND_STUDENT.ACADEMIC_YEAR between ('2556')-('3')+(1) and ('2556'))
-- and (INBOUND_OUTBOUND_STUDENT.FACULTY_CODE in (paramFAC) or 'All' in (paramFAC))
-- and (INBOUND_OUTBOUND_STUDENT.DEPARTMENT_CODE in (paramDEP) or 'All' in (paramDEP))
group by INBOUND_OUTBOUND_STUDENT.ACADEMIC_YEAR,INBOUND_OUTBOUND_STUDENT.TYPE
order by TYPE,ACADEMIC_YEAR;

----6.2 p_inbound_outbound_per_inbound
select INBOUND_OUTBOUND_STUDENT.ACADEMIC_YEAR
,INBOUND_OUTBOUND_STUDENT.COUNTRY
,INBOUND_OUTBOUND_STUDENT.TYPE
,sum(INBOUND_OUTBOUND_STUDENT.NO_OF_STUDENT) as TOTALSTUDENT
from INBOUND_OUTBOUND_STUDENT
where (INBOUND_OUTBOUND_STUDENT.TYPE in ('Inbound'))
and (INBOUND_OUTBOUND_STUDENT.ACADEMIC_YEAR in ('2556'))
--and (INBOUND_OUTBOUND_STUDENT.FACULTY_CODE in (''))
--and (INBOUND_OUTBOUND_STUDENT.DEPARTMENT_CODE in (''))
group by INBOUND_OUTBOUND_STUDENT.ACADEMIC_YEAR,INBOUND_OUTBOUND_STUDENT.TYPE,INBOUND_OUTBOUND_STUDENT.COUNTRY
order by INBOUND_OUTBOUND_STUDENT.COUNTRY,INBOUND_OUTBOUND_STUDENT.TYPE

---6.3 p_inbound_outbound_per_outbound
select INBOUND_OUTBOUND_STUDENT.ACADEMIC_YEAR
,INBOUND_OUTBOUND_STUDENT.COUNTRY
,INBOUND_OUTBOUND_STUDENT.TYPE
,sum(INBOUND_OUTBOUND_STUDENT.NO_OF_STUDENT) as TOTALSTUDENT
from INBOUND_OUTBOUND_STUDENT
where (INBOUND_OUTBOUND_STUDENT.TYPE in ('Outbound'))
and (INBOUND_OUTBOUND_STUDENT.ACADEMIC_YEAR in ('2556'))
--and (INBOUND_OUTBOUND_STUDENT.FACULTY_CODE in (''))
--and (INBOUND_OUTBOUND_STUDENT.DEPARTMENT_CODE in (''))
group by INBOUND_OUTBOUND_STUDENT.ACADEMIC_YEAR,INBOUND_OUTBOUND_STUDENT.TYPE,INBOUND_OUTBOUND_STUDENT.COUNTRY
order by INBOUND_OUTBOUND_STUDENT.COUNTRY,INBOUND_OUTBOUND_STUDENT.TYPE
